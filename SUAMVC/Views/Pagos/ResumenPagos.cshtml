@model SUAMVC.Models.PagosResumenModel
@using SUADATOS
@using SUAMVC.Models
@using System.Text;
@{
    ViewBag.Title = "Detalle de Pagos";
    Layout = "~/Views/Shared/_Layout.cshtml";
    if (!WebSecurity.IsAuthenticated)
    {
        Response.Redirect("~/Home/Index");
    }
    Usuario usuario = Session["UsuarioData"] as Usuario;
    var grid = new WebGrid(source: Model.detalle, rowsPerPage: 10);
    var tableHtml = string.Empty;
    var sb = new StringBuilder();
    //Creamos una lista de columnas
    var gridColumns = new List<WebGridColumn>();

    gridColumns.Add(grid.Column("Pago.anno", "Periodo", format: @<text> @if (@item.Pago.anno != null)
    {  @item.Pago.anno @item.Pago.mes   }</text>, canSort: true));
                                                 
    gridColumns.Add(grid.Column("Asegurado.", "NSS", format: @<text> @if (@item.Asegurado.numeroAfiliacion != null)
    {  @item.Asegurado.numeroAfiliacion }</text>, canSort: true));
                         
    gridColumns.Add(grid.Column("Asegurado", "Nombre", format: @<text> @if (@item.Asegurado.nombreTemporal != null)
    {  @item.Asegurado.nombreTemporal }</text>, canSort: true));
                                
    gridColumns.Add(grid.Column("diasCotizados", "Dias", format: @<text> @if (@item.diasCotizados != null)
    {  @item.diasCotizados }</text>, canSort: true));
                                      
    gridColumns.Add(grid.Column("sdi", "S.D.I.", format: @<text> @if (@item.sdi != null)
    {  @item.sdi }</text>, canSort: true));
                                      
    gridColumns.Add(grid.Column("diasIncapacidad", "Inc.", format: @<text> @if (@item.diasIncapacidad != null)
    {  @item.diasIncapacidad }</text>, canSort: true));
    gridColumns.Add(grid.Column("diasAusentismo", "Aus.", format: @<text> @if (@item.diasAusentismo != null)
    {  @item.diasAusentismo }</text>, canSort: true));
                                    
    gridColumns.Add(grid.Column("cuotaFija", "C.F.", format: @<text> @if (@item.cuotaFija != null)
    {  @item.cuotaFija }</text>, canSort: true));
    gridColumns.Add(grid.Column("expa", "Ex.P", format: @<text> @if (@item.expa != null)
    {  @item.expa }</text>, canSort: true));
                                     
    gridColumns.Add(grid.Column("exo", "Ex. O.", format: @<text> @if (@item.exo != null)
    {  @item.exo }</text>, canSort: true));
    gridColumns.Add(grid.Column("Asegurado", "Ubicación", format: @<text> @if (@item.Asegurado.Cliente.claveCliente != null)
    {  @item.Asegurado.Cliente.claveCliente }</text>, canSort: true));

    gridColumns.Add(grid.Column("PDP", "PDP", format: @<text> @if (@item.pdp != null)
    {  @item.pdp }</text>, canSort: true));
                         
    gridColumns.Add(grid.Column("GMPP", "GMP. Patron", format: @<text> @if (@item.gmpp != null)
    {  @item.gmpp }</text>, canSort: true));

    gridColumns.Add(grid.Column("GMPO", "GMP. Obrero", format: @<text> @if (@item.gmpo != null)
    {  @item.gmpo }</text>, canSort: true));

    gridColumns.Add(grid.Column("rt", "R.T.", format: @<text> @if (@item.rt != null)
    {  @item.rt }</text>, canSort: true));
    gridColumns.Add(grid.Column("ivp", "I.V.P", format: @<text> @if (@item.ivp != null)
    {  @item.ivp }</text>, canSort: true));
    gridColumns.Add(grid.Column("ivo", "I.V.O", format: @<text> @if (@item.ivo != null)
    {  @item.ivo }</text>, canSort: true));
    gridColumns.Add(grid.Column("gps", "G.P.S.", format: @<text> @if (@item.gps != null)
    {  @item.gps }</text>, canSort: true));

    gridColumns.Add(grid.Column("patronal", "Patronal", format: @<text> @if (@item.patronal != null)
    {  @item.patronal }</text>, canSort: true));

    gridColumns.Add(grid.Column("obrera", "Obrera", format: @<text> @if (@item.obrera != null)
    {  @item.obrera }</text>, canSort: true));

    gridColumns.Add(grid.Column("imss", "IMSS", format: @<text> @if (@item.imss != null)
    {  @item.imss }</text>, canSort: true));

    gridColumns.Add(grid.Column("retiro", "Retiro", format: @<text> @if (@item.retiro != null)
    {  @item.retiro }</text>, canSort: true));
    gridColumns.Add(grid.Column("patronalBimestral", "Patronal Bim", format: @<text> @if (@item.patronalBimestral != null)
    {  @item.patronalBimestral }</text>, canSort: true));
    gridColumns.Add(grid.Column("obreraBimestral", "Obrera Bim", format: @<text> @if (@item.obreraBimestral != null)
    {  @item.obreraBimestral }</text>, canSort: true));
                            
    gridColumns.Add(grid.Column("rcv", "R.C.V.", format: @<text> @if (@item.rcv != null)
    {  @item.rcv }</text>, canSort: true)); 
                          
    gridColumns.Add(grid.Column("aportacionsc", "Aportacion SC", format: @<text> @if (@item.aportacionsc != null)
    {  @item.aportacionsc }</text>, canSort: true));
    gridColumns.Add(grid.Column("aportacioncc", "Aportacion CC", format: @<text> @if (@item.aportacioncc != null)
    {  @item.aportacioncc }</text>, canSort: true));
    gridColumns.Add(grid.Column("amortizacion", "Amortizacion", format: @<text> @if (@item.amortizacion != null)
    {  @item.amortizacion }</text>, canSort: true));


    sb.Append(grid.GetHtml(
columns: grid.Columns(gridColumns.ToArray()),
tableStyle: "table table-striped tableSua"
));

    tableHtml = sb.ToString();
}

@section Menu {
    <div>Registro de Pagos IMSS <img src="~/Content/Images/people-b.png" width="15" height="15" /></div>
}

<div class="panel panel-primary">
    <div class="panel-heading">
        Detalle de Pagos IMMS
    </div>
    <div class="panel-body">

        @using (@Html.BeginForm("actualizarPagos", "Pagos", FormMethod.Post))
        {
            @Html.AntiForgeryToken()

            <table style="font-size:12px;">
                <tbody>
                    <tr>
                        <td style="font-weight:bold;">
                            @Language.patron:
                        </td>
                        <td>
                            @Html.DisplayFor(model => model.pago.Patrone.registro)
                        </td>
                        <td colspan="2">@Html.DisplayFor(model => model.pago.Patrone.nombre)</td>
                    </tr>
                    <tr>
                        <td style="font-weight:bold; padding-top:10px">
                            Periodo de Pago:
                        </td>
                        <td style="padding-top:10px">
                            @Html.DisplayFor(model => model.pago.mes)/@Html.DisplayFor(model => model.pago.anno)
                        </td>
                    </tr>
                    <tr>
                        <td style="font-weight:bold; padding-top:10px">
                            Fecha deposito:
                        </td>
                        <td style="padding-top:10px">
                            @Html.EditorFor(model => model.pago.fechaDeposito, new { htmlAttributes = new { @class = "myDate" } })
                        </td>
                        <td>Banco:</td>
                        <td>@Html.bancosDrownList(usuario.Id, "bancoId")</td>
                    </tr>
                    <tr>
                        <td></td>
                        <td colspan="3">
                            <table style="width:300px; margin-top:15px;">
                                <tr>
                                    <th>IMSS</th>
                                    <th>RCV</th>
                                    <th>Infonavit</th>
                                    <th>Total</th>
                                </tr>
                                <tr>
                                    <td>@Model.pago.imss</td>
                                    <td>@Model.pago.rcv</td>
                                    <td>@Model.pago.infonavit</td>
                                    <td>@Model.pago.total</td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="3"></td>
                        <td>
                            <input class="btn btn-success" type="submit" value="@Language.agregar" />
                        </td>
                    </tr>

                </tbody>
            </table>
        }
        <br />
        <br />

    </div>
    @if (!tableHtml.IsEmpty())
    {
        <div id="table-container" class="table-container">
            @Html.Raw(tableHtml)
        </div>
    }
</div>

<div>
    @Html.ActionLink("Regresar", "Index", "Asegurados")
</div>
